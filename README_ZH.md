# BoolQuant

[English](readme.md) | **中文**

![](assets/logo.png)

LLM驱动的布尔规则进化选股

> **100% 本地运行。** 零API调用。您的数据，您的模型，您的阿尔法。永不泄露。

![演示](assets/demo.png)

---

## 快速开始

### 1. 安装依赖
```bash
pip install -r requirements.txt
```

### 2. 配置本地LLM
使用 **LM Studio** 或 **Ollama** 安装并运行本地LLM服务器。

**推荐的GGUF模型（需4GB+显存）：**

- **思考者**（推理/分析）：  
  [Qwen3-4B-Instruct-2507-Gemini-3-Pro-Preview-Distill-GGUF](https://huggingface.co/TeichAI/Qwen3-4B-Instruct-2507-Gemini-3-Pro-Preview-Distill-GGUF) 或 [Falcon-H1R-7B-GGUF](https://huggingface.co/tiiuae/Falcon-H1R-7B-GGUF)

- **总结者**（最终输出）：  
  [Qwen3-4B-Instruct-2507-GGUF](https://huggingface.co/byteshape/Qwen3-4B-Instruct-2507-GGUF)

⚠️ **务必为思考者和总结者使用不同的模型**——这种分离可产生更清晰的推理过程和更简洁的最终响应。切勿在两个角色中重复使用同一模型。

### 3. 配置设置
编辑 `config.json` 以设置关键参数：

| 参数 | 说明 |
|------|------|
| `generations` | 进化周期数量 |
| `attempts` | 每代规则变异次数 |
| `amount_rank_n` | 股票池大小（例如5-20） |
| `return_type` | `o2c`、`o2o`、`c2c` 或 `c2o` |
| `transaction_fee` | 默认值：0.0007 |
| `train_test_ratio` | 训练/测试数据分割比例 |

### 4. 运行应用
```bash
streamlit run app.py
```

## 界面使用

1. 在左侧边栏中**配置**参数：
   - **股票选择**：数据源和前缀过滤器
   - **LLM配置**：选择本地LLM服务和模型
   - **进化设置**：代数、尝试次数、收益类型
   - **数据过滤**：可选的股票池大小数量排名器
   - **日期范围**：选择回测周期
   - **训练/测试分割**：设置验证比例

2. **运行进化**标签页：点击“运行进化”以启动遗传算法

3. **结果**标签页：查看表现最佳的规则、图表和性能指标

4. **股票选择器**标签页：在特定日期测试布尔条件

---

## 工作原理

BoolQuant 通过从基础OHLCV数据生成的LLM指标，进化出**人类可读的布尔规则**以选择股票：

```
((close - low) / (high - low) * volume) > ((close - low) / (high - low) * volume).shift(1)
```

### 进化流程
1. **LLM生成**基于回测反馈的规则变异
2. **规则评估**在历史训练数据上进行
3. **表现最佳者**被选中并进行变异
4. 该过程重复N代
5. **最佳规则**在预留的测试数据上进行测试

### 聚焦股票池选择

与可能输出数百个候选股票的传统投资组合优化方法不同，BoolQuant的**股票池排名器**旨在生成一个**小型、聚焦的列表**（通常5-20只股票）用于研究分析。

这种紧凑方法的优势：
- 对每只候选股票特征的**深入审查**
- 便于进行技术或基本面分析的**可控范围**
- 规则选股逻辑的**清晰可解释性**

系统根据交易量对股票进行排名，并应用进化的布尔规则来过滤股票池。**务必遵循提供的选择提示**（例如，“从前5只开盘价介于前收盘价0.97倍至0.99倍之间的股票中选择”）以确保：
- **无前视偏差**：仅使用决策时点可用的信息
- **可复现的方法论**：确定性的、基于规则的选择
- **研究纪律**：防止任意挑选

这种聚焦的输出旨在用于研究和教育探索，而非交易建议。

---

## 系统要求

- Python 3.10+
- 本地LLM服务器（Ollama或LM Studio）

---

## 数据质量

⚠️ **yfinance数据质量**：数据可能存在缺失、不准确或未经通知的回溯修正——请自行斟酌使用。

⚠️ **数据源一致性**：相同规则在不同数据源上表现可能不同——为保持结果一致性，请坚持使用单一数据源。

## 免责声明

**BoolQuant 仅为个人研究项目，仅用于教育目的。**

- 不适用于实盘交易或投资决策
- 不提供任何形式的担保或保证
- 过往回测表现不代表未来结果
- 仅供研究用途，风险自负

---

## 许可证

个人开放研究许可证。详见 LICENSE 文件。

## 联系方式

P15543223211@hotmail.com